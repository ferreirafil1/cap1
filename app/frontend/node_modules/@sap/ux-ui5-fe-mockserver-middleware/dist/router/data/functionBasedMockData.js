"use strict";
var __extends = (this && this.__extends) || (function () {
    var extendStatics = function (d, b) {
        extendStatics = Object.setPrototypeOf ||
            ({ __proto__: [] } instanceof Array && function (d, b) { d.__proto__ = b; }) ||
            function (d, b) { for (var p in b) if (b.hasOwnProperty(p)) d[p] = b[p]; };
        return extendStatics(d, b);
    };
    return function (d, b) {
        extendStatics(d, b);
        function __() { this.constructor = d; }
        d.prototype = b === null ? Object.create(b) : (__.prototype = b.prototype, new __());
    };
})();
Object.defineProperty(exports, "__esModule", { value: true });
exports.FunctionBasedMockData = void 0;
var fileBasedMockData_1 = require("./fileBasedMockData");
var common_1 = require("./common");
var FunctionBasedMockData = /** @class */ (function (_super) {
    __extends(FunctionBasedMockData, _super);
    function FunctionBasedMockData(mockDataFn, entityType, mockDataEntitySet, contextId) {
        var _this = _super.call(this, ((mockDataFn === null || mockDataFn === void 0 ? void 0 : mockDataFn.getInitialDataSet) ? mockDataFn.getInitialDataSet(contextId) : []) || [], entityType, mockDataEntitySet) || this;
        _this._mockDataFn = mockDataFn;
        _this._mockDataFn.base = {
            addEntry: _super.prototype.addEntry.bind(_this),
            updateEntry: _super.prototype.updateEntry.bind(_this),
            removeEntry: _super.prototype.removeEntry.bind(_this),
            fetchEntries: _super.prototype.fetchEntries.bind(_this),
            hasEntry: _super.prototype.hasEntry.bind(_this),
            hasEntries: _super.prototype.hasEntries.bind(_this),
            getAllEntries: _super.prototype.getAllEntries.bind(_this),
            getEmptyObject: _super.prototype.getEmptyObject.bind(_this),
            getDefaultElement: _super.prototype.getDefaultElement.bind(_this)
        };
        _this._mockDataFn.throwError = function (message, statusCode, messageData, isSAPMessage) {
            if (statusCode === void 0) { statusCode = 500; }
            if (isSAPMessage === void 0) { isSAPMessage = false; }
            var executionError = new common_1.ExecutionError(message, statusCode, messageData, isSAPMessage);
            throw executionError;
        };
        return _this;
    }
    FunctionBasedMockData.prototype.addEntry = function (mockEntry) {
        if (this._mockDataFn.addEntry) {
            return this._mockDataFn.addEntry(mockEntry);
        }
        return _super.prototype.addEntry.call(this, mockEntry);
    };
    FunctionBasedMockData.prototype.updateEntry = function (keyValues, updatedData) {
        if (this._mockDataFn.updateEntry) {
            return this._mockDataFn.updateEntry(keyValues, updatedData);
        }
        return _super.prototype.updateEntry.call(this, keyValues, updatedData);
    };
    FunctionBasedMockData.prototype.removeEntry = function (keyValues) {
        if (this._mockDataFn.removeEntry) {
            return this._mockDataFn.removeEntry(keyValues);
        }
        return _super.prototype.removeEntry.call(this, keyValues);
    };
    FunctionBasedMockData.prototype.fetchEntries = function (keyValues) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.fetchEntries) {
            return this._mockDataFn.fetchEntries(keyValues);
        }
        else {
            return _super.prototype.fetchEntries.call(this, keyValues);
        }
    };
    FunctionBasedMockData.prototype.hasEntry = function (keyValues) {
        if (this._mockDataFn.hasEntry) {
            return this._mockDataFn.hasEntry(keyValues);
        }
        return _super.prototype.hasEntry.call(this, keyValues);
    };
    FunctionBasedMockData.prototype.hasEntries = function () {
        if (this._mockDataFn.hasEntries) {
            return this._mockDataFn.hasEntries();
        }
        return _super.prototype.hasEntries.call(this);
    };
    FunctionBasedMockData.prototype.getEmptyObject = function () {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.getEmptyObject) {
            return this._mockDataFn.getEmptyObject();
        }
        else {
            return _super.prototype.getEmptyObject.call(this);
        }
    };
    FunctionBasedMockData.prototype.getDefaultElement = function () {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.getDefaultElement) {
            return this._mockDataFn.getDefaultElement();
        }
        else {
            return _super.prototype.getDefaultElement.call(this);
        }
    };
    FunctionBasedMockData.prototype.generateKey = function (property, lineIndex) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.generateKey) {
            return this._mockDataFn.generateKey(property);
        }
        else {
            return _super.prototype.generateKey.call(this, property, lineIndex);
        }
    };
    FunctionBasedMockData.prototype.getAllEntries = function () {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.getAllEntries) {
            return this._mockDataFn.getAllEntries();
        }
        else {
            return _super.prototype.getAllEntries.call(this);
        }
    };
    FunctionBasedMockData.prototype.onBeforeAction = function (actionDefinition, actionData, keys) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.onBeforeAction) {
            return this._mockDataFn.onBeforeAction(actionDefinition, actionData, keys);
        }
        else {
            return _super.prototype.onBeforeAction.call(this, actionDefinition, actionData, keys);
        }
    };
    FunctionBasedMockData.prototype.executeAction = function (actionDefinition, actionData, keys) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.executeAction) {
            return this._mockDataFn.executeAction(actionDefinition, actionData, keys);
        }
        else {
            return _super.prototype.executeAction.call(this, actionDefinition, actionData, keys);
        }
    };
    FunctionBasedMockData.prototype.onAfterAction = function (actionDefinition, actionData, keys, responseData) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.onAfterAction) {
            return this._mockDataFn.onAfterAction(actionDefinition, actionData, keys, responseData);
        }
        else {
            return _super.prototype.onAfterAction.call(this, actionDefinition, actionData, keys, responseData);
        }
    };
    FunctionBasedMockData.prototype.onAfterUpdateEntry = function (keyValues, updatedData) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.onAfterUpdateEntry) {
            return this._mockDataFn.onAfterUpdateEntry(keyValues, updatedData);
        }
        else {
            return _super.prototype.onAfterUpdateEntry.call(this, keyValues, updatedData);
        }
    };
    FunctionBasedMockData.prototype.onBeforeUpdateEntry = function (keyValues, updatedData) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.onBeforeUpdateEntry) {
            return this._mockDataFn.onBeforeUpdateEntry(keyValues, updatedData);
        }
        else {
            return _super.prototype.onBeforeUpdateEntry.call(this, keyValues, updatedData);
        }
    };
    FunctionBasedMockData.prototype.hasCustomAggregate = function (customAggregateName) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.hasCustomAggregate) {
            return this._mockDataFn.hasCustomAggregate(customAggregateName);
        }
        else {
            return _super.prototype.hasCustomAggregate.call(this, customAggregateName);
        }
    };
    FunctionBasedMockData.prototype.performCustomAggregate = function (customAggregateName, dataToAggregate) {
        var _a;
        if ((_a = this._mockDataFn) === null || _a === void 0 ? void 0 : _a.performCustomAggregate) {
            return this._mockDataFn.performCustomAggregate(customAggregateName, dataToAggregate);
        }
        else {
            return _super.prototype.performCustomAggregate.call(this, customAggregateName, dataToAggregate);
        }
    };
    return FunctionBasedMockData;
}(fileBasedMockData_1.FileBasedMockData));
exports.FunctionBasedMockData = FunctionBasedMockData;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiZnVuY3Rpb25CYXNlZE1vY2tEYXRhLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL3JvdXRlci9kYXRhL2Z1bmN0aW9uQmFzZWRNb2NrRGF0YS50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7Ozs7Ozs7Ozs7O0FBQ0EseURBQXdFO0FBRXhFLG1DQUE4RDtBQXlCOUQ7SUFBMkMseUNBQWlCO0lBR3hELCtCQUNJLFVBQStCLEVBQy9CLFVBQXNCLEVBQ3RCLGlCQUFxQyxFQUNyQyxTQUFpQjtRQUpyQixZQU1JLGtCQUNJLENBQUMsQ0FBQSxVQUFVLGFBQVYsVUFBVSx1QkFBVixVQUFVLENBQUUsaUJBQWlCLEVBQUMsQ0FBQyxDQUFDLFVBQVUsQ0FBQyxpQkFBaUIsQ0FBQyxTQUFTLENBQUMsQ0FBQyxDQUFDLENBQUMsRUFBRSxDQUFDLElBQUksRUFBRSxFQUNwRixVQUFVLEVBQ1YsaUJBQWlCLENBQ3BCLFNBc0JKO1FBckJHLEtBQUksQ0FBQyxXQUFXLEdBQUcsVUFBVSxDQUFDO1FBQzlCLEtBQUksQ0FBQyxXQUFXLENBQUMsSUFBSSxHQUFHO1lBQ3BCLFFBQVEsRUFBRSxpQkFBTSxRQUFRLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQztZQUNuQyxXQUFXLEVBQUUsaUJBQU0sV0FBVyxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUM7WUFDekMsV0FBVyxFQUFFLGlCQUFNLFdBQVcsQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDO1lBQ3pDLFlBQVksRUFBRSxpQkFBTSxZQUFZLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQztZQUMzQyxRQUFRLEVBQUUsaUJBQU0sUUFBUSxDQUFDLElBQUksQ0FBQyxLQUFJLENBQUM7WUFDbkMsVUFBVSxFQUFFLGlCQUFNLFVBQVUsQ0FBQyxJQUFJLENBQUMsS0FBSSxDQUFDO1lBQ3ZDLGFBQWEsRUFBRSxpQkFBTSxhQUFhLENBQUMsSUFBSSxDQUFDLEtBQUksQ0FBQztZQUM3QyxjQUFjLEVBQUUs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Q0gsT0FBTyxpQkFBTSxrQkFBa0IsWUFBQyxtQkFBbUIsQ0FBQyxDQUFDO1NBQ3hEO0lBQ0wsQ0FBQztJQUVELHNEQUFzQixHQUF0QixVQUF1QixtQkFBMkIsRUFBRSxlQUFzQjs7UUFDdEUsVUFBSSxJQUFJLENBQUMsV0FBVywwQ0FBRSxzQkFBc0IsRUFBRTtZQUMxQyxPQUFPLElBQUksQ0FBQyxXQUFXLENBQUMsc0JBQXNCLENBQUMsbUJBQW1CLEVBQUUsZUFBZSxDQUFDLENBQUM7U0FDeEY7YUFBTTtZQUNILE9BQU8saUJBQU0sc0JBQXNCLFlBQUMsbUJBQW1CLEVBQUUsZUFBZSxDQUFDLENBQUM7U0FDN0U7SUFDTCxDQUFDO0lBQ0wsNEJBQUM7QUFBRCxDQUFDLEFBdEtELENBQTJDLHFDQUFpQixHQXNLM0Q7QUF0S1ksc0RBQXFCIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgRW50aXR5VHlwZSwgUHJvcGVydHkgfSBmcm9tICdAc2FwLXV4L2Fubm90YXRpb24tY29udmVydGVyJztcbmltcG9ydCB7IEZpbGVCYXNlZE1vY2tEYXRhLCBLZXlEZWZpbml0aW9ucyB9IGZyb20gJy4vZmlsZUJhc2VkTW9ja0RhdGEnO1xuaW1wb3J0IHsgQWN0aW9uIH0gZnJvbSAnQHNhcC11eC92b2NhYnVsYXJpZXMtdHlwZXMnO1xuaW1wb3J0IHsgRW50aXR5U2V0SW50ZXJmYWNlLCBFeGVjdXRpb25FcnJvciB9IGZyb20gJy4vY29tbW9uJztcblxuZXhwb3J0IHR5cGUgTW9ja0RhdGFDb250cmlidXRvciA9IHtcbiAgICBnZXRJbml0aWFsRGF0YVNldD86IChjb250ZXh0SWQ6IHN0cmluZykgPT4gb2JqZWN0W107XG4gICAgYWRkRW50cnk/OiAobW9ja0VudHJ5OiBvYmplY3QpID0+IHZvaWQ7XG4gICAgdXBkYXRlRW50cnk/OiAoa2V5VmFsdWVzOiBLZXlEZWZpbml0aW9ucywgbmV3RGF0YTogb2JqZWN0KSA9PiB2b2lkO1xuICAgIHJlbW92ZUVudHJ5PzogKGtleVZhbHVlczogS2V5RGVmaW5pdGlvbnMpID0+IHZvaWQ7XG4gICAgaGFzRW50cnk/OiAoa2V5VmFsdWVzOiBLZXlEZWZpbml0aW9ucykgPT4gYm9vbGVhbjtcbiAgICBoYXNFbnRyaWVzPzogKCkgPT4gYm9vbGVhbjtcbiAgICBmZXRjaEVudHJpZXM/OiAoa2V5VmFsdWVzOiBLZXlEZWZpbml0aW9ucykgPT4gb2JqZWN0W107XG4gICAgZ2V0QWxsRW50cmllcz86ICgpID0+IG9iamVjdFtdO1xuICAgIGdldEVtcHR5T2JqZWN0PzogKCkgPT4gb2JqZWN0O1xuICAgIGdldERlZmF1bHRFbGVtZW50PzogKCkgPT4gb2JqZWN0O1xuICAgIGdlbmVyYXRlS2V5PzogKHByb3BlcnR5OiBQcm9wZXJ0eSkgPT4gYW55O1xuICAgIG9uQmVmb3JlQWN0aW9uKGFjdGlvbkRlZmluaXRpb246IEFjdGlvbiwgYWN0aW9uRGF0YTogYW55LCBrZXlzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogb2JqZWN0O1xuICAgIGV4ZWN1dGVBY3Rpb24oYWN0aW9uRGVmaW5pdGlvbjogQWN0aW9uLCBhY3Rpb25EYXRhOiBhbnksIGtleXM6IFJlY29yZDxzdHJpbmcsIGFueT4pOiBvYmplY3Q7XG4gICAgb25BZnRlckFjdGlvbihhY3Rpb25EZWZpbml0aW9uOiBBY3Rpb24sIGFjdGlvbkRhdGE6IGFueSwga2V5czogUmVjb3JkPHN0cmluZywgYW55PiwgcmVzcG9uc2VEYXRhOiBhbnkpOiBhbnk7XG4gICAgb25BZnRlclVwZGF0ZUVudHJ5KGtleVZhbHVlczogS2V5RGVmaW5pdGlvbnMsIHVwZGF0ZWREYXRhOiBvYmplY3QpOiB2b2lkO1xuICAgIG9uQmVmb3JlVXBkYXRlRW50cnkoa2V5VmFsdWVzOiBLZXlEZWZpbml0aW9ucywgdXBkYXRlZERhdGE6IG9iamVjdCk6IHZvaWQ7XG4gICAgaGFzQ3VzdG9tQWdncmVnYXRlKGN1c3RvbUFnZ3JlZ2F0ZU5hbWU6IHN0cmluZyk6IGJvb2xlYW47XG4gICAgcGVyZm9ybUN1c3RvbUFnZ3JlZ2F0ZShjdXN0b21BZ2dyZWdhdGVOYW1lOiBzdHJpbmcsIGRhdGFUb0FnZ3JlZ2F0ZTogYW55W10pOiBhbnk7XG4gICAgdGhyb3dFcnJvcihtZXNzYWdlOiBzdHJpbmcsIHN0YXR1c0NvZGU/OiBudW1iZXIsIG1lc3NhZ2VEYXRhPzogb2JqZWN0KTtcbiAgICBiYXNlOiBhbnk7XG59O1xuXG5leHBvcnQgY2xhc3MgRnVuY3Rpb25CYXNlZE1vY2tEYXRhIGV4dGVuZHMgRmlsZUJhc2VkTW9ja0RhdGEge1xuICAgIHByaXZhdGUgX21vY2tEYXRhRm46IE1vY2tEYXRhQ29udHJpYnV0b3I7XG5cbiAgICBjb25zdHJ1Y3RvcihcbiAgICAgICAgbW9ja0RhdGFGbjogTW9ja0RhdGFDb250cmlidXRvcixcbiAgICAgICAgZW50aXR5VHlwZTogRW50aXR5VHlwZSxcbiAgICAgICAgbW9ja0RhdGFFbnRpdHlTZXQ6IEVudGl0eVNldEludGVyZmFjZSxcbiAgICAgICAgY29udGV4dElkOiBzdHJpbmdcbiAgICApIHtcbiAgICAgICAgc3VwZXIoXG4gICAgICAgICAgICAobW9ja0RhdGFGbj8uZ2V0SW5pdGlhbERhdGFTZXQgPyBtb2NrRGF0YUZuLmdldEluaXRpYWxEYXRhU2V0KGNvbnRleHRJZCkgOiBbXSkgfHwgW10sXG4gICAgICAgICAgICBlbnRpdHlUeXBlLFxuICAgICAgICAgICAgbW9ja0RhdGFFbnRpdHlTZXRcbiAgICAgICAgKTtcbiAgICAgICAgdGhpcy5fbW9ja0RhdGFGbiA9IG1vY2tEYXRhRm47XG4gICAgICAgIHRoaXMuX21vY2tEYXRhRm4uYmFzZSA9IHtcbiAgICAgICAgICAgIGFkZEVudHJ5OiBzdXBlci5hZGRFbnRyeS5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgdXBkYXRlRW50cnk6IHN1cGVyLnVwZGF0ZUVudHJ5LmJpbmQodGhpcyksXG4gICAgICAgICAgICByZW1vdmVFbnRyeTogc3VwZXIucmVtb3ZlRW50cnkuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGZldGNoRW50cmllczogc3VwZXIuZmV0Y2hFbnRyaWVzLmJpbmQodGhpcyksXG4gICAgICAgICAgICBoYXNFbnRyeTogc3VwZXIuaGFzRW50cnkuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGhhc0VudHJpZXM6IHN1cGVyLmhhc0VudHJpZXMuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGdldEFsbEVudHJpZXM6IHN1cGVyLmdldEFsbEVudHJpZXMuYmluZCh0aGlzKSxcbiAgICAgICAgICAgIGdldEVtcHR5T2JqZWN0OiBzdXBlci5nZXRFbXB0eU9iamVjdC5iaW5kKHRoaXMpLFxuICAgICAgICAgICAgZ2V0RGVmYXVsdEVsZW1lbnQ6IHN1cGVyLmdldERlZmF1bHRFbGVtZW50LmJpbmQodGhpcylcbiAgICAgICAgfTtcbiAgICAgICAgdGhpcy5fbW9ja0RhdGFGbi50aHJvd0Vycm9yID0gZnVuY3Rpb24oXG4gICAgICAgICAgICBtZXNzYWdlOiBzdHJpbmcsXG4gICAgICAgICAgICBzdGF0dXNDb2RlID0gNTAwLFxuICAgICAgICAgICAgbWVzc2FnZURhdGE/OiBvYmplY3QsXG4gICAgICAgICAgICBpc1NBUE1lc3NhZ2UgPSBmYWxzZVxuICAgICAgICApIHtcbiAgICAgICAgICAgIGNvbnN0IGV4ZWN1dGlvbkVycm9yID0gbmV3IEV4ZWN1dGlvbkVycm9yKG1lc3NhZ2UsIHN0YXR1c0NvZGUsIG1lc3NhZ2VEYXRhLCBpc1NBUE1lc3NhZ2UpO1xuICAgICAgICAgICAgdGhyb3cgZXhlY3V0aW9uRXJyb3I7XG4gICAgICAgIH07XG4gICAgfVxuXG4gICAgYWRkRW50cnkobW9ja0VudHJ5KTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9tb2NrRGF0YUZuLmFkZEVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5hZGRFbnRyeShtb2NrRW50cnkpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdXBlci5hZGRFbnRyeShtb2NrRW50cnkpO1xuICAgIH1cblxuICAgIHVwZGF0ZUVudHJ5KGtleVZhbHVlczogS2V5RGVmaW5pdGlvbnMsIHVwZGF0ZWREYXRhOiBvYmplY3QpOiB2b2lkIHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4udXBkYXRlRW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2NrRGF0YUZuLnVwZGF0ZUVudHJ5KGtleVZhbHVlcywgdXBkYXRlZERhdGEpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdXBlci51cGRhdGVFbnRyeShrZXlWYWx1ZXMsIHVwZGF0ZWREYXRhKTtcbiAgICB9XG5cbiAgICByZW1vdmVFbnRyeShrZXlWYWx1ZXM6IEtleURlZmluaXRpb25zKTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9tb2NrRGF0YUZuLnJlbW92ZUVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5yZW1vdmVFbnRyeShrZXlWYWx1ZXMpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdXBlci5yZW1vdmVFbnRyeShrZXlWYWx1ZXMpO1xuICAgIH1cblxuICAgIGZldGNoRW50cmllcyhrZXlWYWx1ZXM6IEtleURlZmluaXRpb25zKTogb2JqZWN0W10ge1xuICAgICAgICBpZiAodGhpcy5fbW9ja0RhdGFGbj8uZmV0Y2hFbnRyaWVzKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5mZXRjaEVudHJpZXMoa2V5VmFsdWVzKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzdXBlci5mZXRjaEVudHJpZXMoa2V5VmFsdWVzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGhhc0VudHJ5KGtleVZhbHVlczogS2V5RGVmaW5pdGlvbnMpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4uaGFzRW50cnkpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2NrRGF0YUZuLmhhc0VudHJ5KGtleVZhbHVlcyk7XG4gICAgICAgIH1cbiAgICAgICAgcmV0dXJuIHN1cGVyLmhhc0VudHJ5KGtleVZhbHVlcyk7XG4gICAgfVxuXG4gICAgaGFzRW50cmllcygpOiBib29sZWFuIHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4uaGFzRW50cmllcykge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vY2tEYXRhRm4uaGFzRW50cmllcygpO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiBzdXBlci5oYXNFbnRyaWVzKCk7XG4gICAgfVxuXG4gICAgZ2V0RW1wdHlPYmplY3QoKTogb2JqZWN0IHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4/LmdldEVtcHR5T2JqZWN0KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5nZXRFbXB0eU9iamVjdCgpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHN1cGVyLmdldEVtcHR5T2JqZWN0KCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXREZWZhdWx0RWxlbWVudCgpOiBvYmplY3Qge1xuICAgICAgICBpZiAodGhpcy5fbW9ja0RhdGFGbj8uZ2V0RGVmYXVsdEVsZW1lbnQpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2NrRGF0YUZuLmdldERlZmF1bHRFbGVtZW50KCk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2V0RGVmYXVsdEVsZW1lbnQoKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIGdlbmVyYXRlS2V5KHByb3BlcnR5OiBQcm9wZXJ0eSwgbGluZUluZGV4OiBudW1iZXIpIHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4/LmdlbmVyYXRlS2V5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5nZW5lcmF0ZUtleShwcm9wZXJ0eSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZ2VuZXJhdGVLZXkocHJvcGVydHksIGxpbmVJbmRleCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBnZXRBbGxFbnRyaWVzKCk6IG9iamVjdFtdIHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4/LmdldEFsbEVudHJpZXMpIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2NrRGF0YUZuLmdldEFsbEVudHJpZXMoKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzdXBlci5nZXRBbGxFbnRyaWVzKCk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkJlZm9yZUFjdGlvbihhY3Rpb25EZWZpbml0aW9uOiBBY3Rpb24sIGFjdGlvbkRhdGE6IGFueSwga2V5czogUmVjb3JkPHN0cmluZywgYW55Pik6IG9iamVjdCB7XG4gICAgICAgIGlmICh0aGlzLl9tb2NrRGF0YUZuPy5vbkJlZm9yZUFjdGlvbikge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vY2tEYXRhRm4ub25CZWZvcmVBY3Rpb24oYWN0aW9uRGVmaW5pdGlvbiwgYWN0aW9uRGF0YSwga2V5cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIub25CZWZvcmVBY3Rpb24oYWN0aW9uRGVmaW5pdGlvbiwgYWN0aW9uRGF0YSwga2V5cyk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBleGVjdXRlQWN0aW9uKGFjdGlvbkRlZmluaXRpb246IEFjdGlvbiwgYWN0aW9uRGF0YTogYW55LCBrZXlzOiBSZWNvcmQ8c3RyaW5nLCBhbnk+KTogb2JqZWN0IHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4/LmV4ZWN1dGVBY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2NrRGF0YUZuLmV4ZWN1dGVBY3Rpb24oYWN0aW9uRGVmaW5pdGlvbiwgYWN0aW9uRGF0YSwga2V5cyk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuZXhlY3V0ZUFjdGlvbihhY3Rpb25EZWZpbml0aW9uLCBhY3Rpb25EYXRhLCBrZXlzKTtcbiAgICAgICAgfVxuICAgIH1cblxuICAgIG9uQWZ0ZXJBY3Rpb24oYWN0aW9uRGVmaW5pdGlvbjogQWN0aW9uLCBhY3Rpb25EYXRhOiBhbnksIGtleXM6IFJlY29yZDxzdHJpbmcsIGFueT4sIHJlc3BvbnNlRGF0YTogYW55KTogYW55IHtcbiAgICAgICAgaWYgKHRoaXMuX21vY2tEYXRhRm4/Lm9uQWZ0ZXJBY3Rpb24pIHtcbiAgICAgICAgICAgIHJldHVybiB0aGlzLl9tb2NrRGF0YUZuLm9uQWZ0ZXJBY3Rpb24oYWN0aW9uRGVmaW5pdGlvbiwgYWN0aW9uRGF0YSwga2V5cywgcmVzcG9uc2VEYXRhKTtcbiAgICAgICAgfSBlbHNlIHtcbiAgICAgICAgICAgIHJldHVybiBzdXBlci5vbkFmdGVyQWN0aW9uKGFjdGlvbkRlZmluaXRpb24sIGFjdGlvbkRhdGEsIGtleXMsIHJlc3BvbnNlRGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG5cbiAgICBvbkFmdGVyVXBkYXRlRW50cnkoa2V5VmFsdWVzOiBLZXlEZWZpbml0aW9ucywgdXBkYXRlZERhdGE6IG9iamVjdCk6IHZvaWQge1xuICAgICAgICBpZiAodGhpcy5fbW9ja0RhdGFGbj8ub25BZnRlclVwZGF0ZUVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5vbkFmdGVyVXBkYXRlRW50cnkoa2V5VmFsdWVzLCB1cGRhdGVkRGF0YSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIub25BZnRlclVwZGF0ZUVudHJ5KGtleVZhbHVlcywgdXBkYXRlZERhdGEpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgb25CZWZvcmVVcGRhdGVFbnRyeShrZXlWYWx1ZXM6IEtleURlZmluaXRpb25zLCB1cGRhdGVkRGF0YTogb2JqZWN0KTogdm9pZCB7XG4gICAgICAgIGlmICh0aGlzLl9tb2NrRGF0YUZuPy5vbkJlZm9yZVVwZGF0ZUVudHJ5KSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5vbkJlZm9yZVVwZGF0ZUVudHJ5KGtleVZhbHVlcywgdXBkYXRlZERhdGEpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHN1cGVyLm9uQmVmb3JlVXBkYXRlRW50cnkoa2V5VmFsdWVzLCB1cGRhdGVkRGF0YSk7XG4gICAgICAgIH1cbiAgICB9XG4gICAgaGFzQ3VzdG9tQWdncmVnYXRlKGN1c3RvbUFnZ3JlZ2F0ZU5hbWU6IHN0cmluZyk6IGJvb2xlYW4ge1xuICAgICAgICBpZiAodGhpcy5fbW9ja0RhdGFGbj8uaGFzQ3VzdG9tQWdncmVnYXRlKSB7XG4gICAgICAgICAgICByZXR1cm4gdGhpcy5fbW9ja0RhdGFGbi5oYXNDdXN0b21BZ2dyZWdhdGUoY3VzdG9tQWdncmVnYXRlTmFtZSk7XG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICByZXR1cm4gc3VwZXIuaGFzQ3VzdG9tQWdncmVnYXRlKGN1c3RvbUFnZ3JlZ2F0ZU5hbWUpO1xuICAgICAgICB9XG4gICAgfVxuXG4gICAgcGVyZm9ybUN1c3RvbUFnZ3JlZ2F0ZShjdXN0b21BZ2dyZWdhdGVOYW1lOiBzdHJpbmcsIGRhdGFUb0FnZ3JlZ2F0ZTogYW55W10pOiBhbnkge1xuICAgICAgICBpZiAodGhpcy5fbW9ja0RhdGFGbj8ucGVyZm9ybUN1c3RvbUFnZ3JlZ2F0ZSkge1xuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX21vY2tEYXRhRm4ucGVyZm9ybUN1c3RvbUFnZ3JlZ2F0ZShjdXN0b21BZ2dyZWdhdGVOYW1lLCBkYXRhVG9BZ2dyZWdhdGUpO1xuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgICAgcmV0dXJuIHN1cGVyLnBlcmZvcm1DdXN0b21BZ2dyZWdhdGUoY3VzdG9tQWdncmVnYXRlTmFtZSwgZGF0YVRvQWdncmVnYXRlKTtcbiAgICAgICAgfVxuICAgIH1cbn1cbiJdfQ==