"use strict";
var __importDefault = (this && this.__importDefault) || function (mod) {
    return (mod && mod.__esModule) ? mod : { "default": mod };
};
Object.defineProperty(exports, "__esModule", { value: true });
exports.catalogService = void 0;
var router_1 = __importDefault(require("router"));
var fileLoader_1 = require("./utils/fileLoader");
function catalogService(config, version) {
    if (version === void 0) { version = 2; }
    var router = router_1.default();
    router.get('/ServiceCollection', function (req, res) {
        res.json({
            d: {
                results: [
                    {
                        ID: config.service.name
                    }
                ]
            }
        });
    });
    router.get('/ServiceCollection\\(*', function (req, res) {
        res.json({
            d: {
                results: [
                    {
                        TechnicalName: config.service.name,
                        Version: version
                    }
                ]
            }
        });
    });
    if (config.annotations) {
        router.get('/Annotations*', function (req, res) {
            fileLoader_1.loadFile(config.annotations.localPath).then(function (data) {
                res.contentType('application/xml').send(data);
            });
        });
    }
    return router;
}
exports.catalogService = catalogService;
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiY2F0YWxvZy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uL3NyYy9yb3V0ZXIvY2F0YWxvZy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiOzs7Ozs7QUFDQSxrREFBNEI7QUFFNUIsaURBQThDO0FBRTlDLFNBQWdCLGNBQWMsQ0FBQyxNQUE2QixFQUFFLE9BQVc7SUFBWCx3QkFBQSxFQUFBLFdBQVc7SUFDckUsSUFBTSxNQUFNLEdBQVcsZ0JBQU0sRUFBRSxDQUFDO0lBRWhDLE1BQU0sQ0FBQyxHQUFHLENBQUMsb0JBQW9CLEVBQUUsVUFBQyxHQUFZLEVBQUUsR0FBYTtRQUN6RCxHQUFHLENBQUMsSUFBSSxDQUFDO1lBQ0wsQ0FBQyxFQUFFO2dCQUNDLE9BQU8sRUFBRTtvQkFDTDt3QkFDSSxFQUFFLEVBQUUsTUFBTSxDQUFDLE9BQU8sQ0FBQyxJQUFJO3FCQUMxQjtpQkFDSjthQUNKO1NBQ0osQ0FBQyxDQUFDO0lBQ1AsQ0FBQyxDQUFDLENBQUM7SUFFSCxNQUFNLENBQUMsR0FBRyxDQUFDLHdCQUF3QixFQUFFLFVBQUMsR0FBWSxFQUFFLEdBQWE7UUFDN0QsR0FBRyxDQUFDLElBQUksQ0FBQztZQUNMLENBQUMsRUFBRTtnQkFDQyxPQUFPLEVBQUU7b0JBQ0w7d0JBQ0ksYUFBYSxFQUFFLE1BQU0sQ0FBQyxPQUFPLENBQUMsSUFBSTt3QkFDbEMsT0FBTyxFQUFFLE9BQU87cUJBQ25CO2lCQUNKO2FBQ0o7U0FDSixDQUFDLENBQUM7SUFDUCxDQUFDLENBQUMsQ0FBQztJQUVILElBQUksTUFBTSxDQUFDLFdBQVcsRUFBRTtRQUNwQixNQUFNLENBQUMsR0FBRyxDQUFDLGVBQWUsRUFBRSxVQUFDLEdBQVksRUFBRSxHQUFhO1lBQ3BELHFCQUFRLENBQUMsTUFBTSxDQUFDLFdBQVcsQ0FBQyxTQUFTLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBQyxJQUFJO2dCQUM3QyxHQUFHLENBQUMsV0FBVyxDQUFDLGlCQUFpQixDQUFDLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQyxDQUFDO1lBQ2xELENBQUMsQ0FBQyxDQUFDO1FBQ1AsQ0FBQyxDQUFDLENBQUM7S0FDTjtJQUVELE9BQU8sTUFBTSxDQUFDO0FBQ2xCLENBQUM7QUFyQ0Qsd0NBcUNDIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgUmVxdWVzdCwgUmVzcG9uc2UgfSBmcm9tICdleHByZXNzJztcbmltcG9ydCBSb3V0ZXIgZnJvbSAncm91dGVyJztcbmltcG9ydCB7IEZpbGVCYXNlZFNlcnZlckNvbmZpZywgU2VydmVyQ29uZmlnIH0gZnJvbSAnLi4vYXBpJztcbmltcG9ydCB7IGxvYWRGaWxlIH0gZnJvbSAnLi91dGlscy9maWxlTG9hZGVyJztcblxuZXhwb3J0IGZ1bmN0aW9uIGNhdGFsb2dTZXJ2aWNlKGNvbmZpZzogRmlsZUJhc2VkU2VydmVyQ29uZmlnLCB2ZXJzaW9uID0gMik6IFJvdXRlciB7XG4gICAgY29uc3Qgcm91dGVyOiBSb3V0ZXIgPSBSb3V0ZXIoKTtcblxuICAgIHJvdXRlci5nZXQoJy9TZXJ2aWNlQ29sbGVjdGlvbicsIChyZXE6IFJlcXVlc3QsIHJlczogUmVzcG9uc2UpID0+IHtcbiAgICAgICAgcmVzLmpzb24oe1xuICAgICAgICAgICAgZDoge1xuICAgICAgICAgICAgICAgIHJlc3VsdHM6IFtcbiAgICAgICAgICAgICAgICAgICAge1xuICAgICAgICAgICAgICAgICAgICAgICAgSUQ6IGNvbmZpZy5zZXJ2aWNlLm5hbWVcbiAgICAgICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgfSk7XG4gICAgfSk7XG5cbiAgICByb3V0ZXIuZ2V0KCcvU2VydmljZUNvbGxlY3Rpb25cXFxcKConLCAocmVxOiBSZXF1ZXN0LCByZXM6IFJlc3BvbnNlKSA9PiB7XG4gICAgICAgIHJlcy5qc29uKHtcbiAgICAgICAgICAgIGQ6IHtcbiAgICAgICAgICAgICAgICByZXN1bHRzOiBbXG4gICAgICAgICAgICAgICAgICAgIHtcbiAgICAgICAgICAgICAgICAgICAgICAgIFRlY2huaWNhbE5hbWU6IGNvbmZpZy5zZXJ2aWNlLm5hbWUsXG4gICAgICAgICAgICAgICAgICAgICAgICBWZXJzaW9uOiB2ZXJzaW9uXG4gICAgICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgICBdXG4gICAgICAgICAgICB9XG4gICAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaWYgKGNvbmZpZy5hbm5vdGF0aW9ucykge1xuICAgICAgICByb3V0ZXIuZ2V0KCcvQW5ub3RhdGlvbnMqJywgKHJlcTogUmVxdWVzdCwgcmVzOiBSZXNwb25zZSkgPT4ge1xuICAgICAgICAgICAgbG9hZEZpbGUoY29uZmlnLmFubm90YXRpb25zLmxvY2FsUGF0aCkudGhlbigoZGF0YSkgPT4ge1xuICAgICAgICAgICAgICAgIHJlcy5jb250ZW50VHlwZSgnYXBwbGljYXRpb24veG1sJykuc2VuZChkYXRhKTtcbiAgICAgICAgICAgIH0pO1xuICAgICAgICB9KTtcbiAgICB9XG5cbiAgICByZXR1cm4gcm91dGVyO1xufVxuIl19